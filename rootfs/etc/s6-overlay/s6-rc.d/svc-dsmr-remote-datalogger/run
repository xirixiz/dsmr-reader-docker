#!/command/execlineb -P
# /etc/s6-overlay/s6-rc.d/dsmr_client_datalogger/run
# shellcheck shell=bash

with-contenv

if [[ "${DSMRREADER_OPERATION_MODE}" = api_client ]]; then
    echo "Starting DSMR Reader - remote datalogger (api_client)..."
    cd /app || exit
    nice -n 5
    s6-setuidgid app
    /usr/local/bin/python3 -u /dsmr/dsmr_datalogger/scripts/dsmr_datalogger_api_client.py
else
    sleep infinity
fi